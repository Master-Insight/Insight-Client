---
import "swiper/css"; // Estilos básicos de Swiper
import "swiper/css/navigation"; // Estilos para la navegación
import "swiper/css/pagination"; // Estilos para la paginación

import { getCollection } from "astro:content";

const { staffSlugs = [] } = Astro.props; // Lista de slugs de usuarios a mostrar
const staff = await getCollection("staff"); // Obtenemos todos los usuarios desde la colección

// Filtrar los usuarios por los slugs proporcionados
const filteredStaff = staff.filter((staff) => staffSlugs.includes(staff.slug));

// Imagen predeterminada para usuarios sin foto
const defaultPhoto = {
  boy: "/default/default-boy.jpg",
  girl: "/default/default-girl.jpg",
};
// console.log(filteredStaff);
---

<div class="staffSwiper w-full h-auto">
  <!-- Contenedor de diapositivas -->
  <div class="swiper-wrapper flex justify-center">
    {
      filteredStaff.map((staff, index) => {
        return (
          <div class="swiper-slide text-center gap-2" key={index}>
            <img
              src={
                staff.data.photo ||
                defaultPhoto[staff.data.gender] ||
                "/default/default-boy.jpg"
              }
              alt={`Foto de ${staff.data.fullName}`}
              class="w-24 h-24 object-cover rounded-full shadow-lg"
            />
            <h3 class="text-lg font-bold">{staff.data.fullName}</h3>
            <p class="text-sm text-gray-500">{staff.data.roleIT[0]}</p>
          </div>
        );
      })
    }
  </div>

  <!-- Controles de navegación -->
  <div class="swiper-button-prev"></div>
  <div class="swiper-button-next"></div>

  <!-- Paginación -->
  <div class="swiper-pagination"></div>
</div>

<script>
  // Inicializar Swiper en el cliente
  import Swiper from "swiper";
  import { Navigation, Pagination, Autoplay } from "swiper/modules";

  document.addEventListener("DOMContentLoaded", () => {
    new Swiper(".staffSwiper", {
      modules: [Navigation, Pagination, Autoplay],
      spaceBetween: 20,
      slidesPerView: 3, // Mostrar 3 usuarios al mismo tiempo
      loop: true, // Hacer que el slider sea circular
      autoplay: {
        delay: 3000, // Cambiar cada 3 segundos
        disableOnInteraction: false, // No detenerse al interactuar
      },
      navigation: {
        nextEl: ".swiper-button-next",
        prevEl: ".swiper-button-prev",
      },
      pagination: {
        el: ".swiper-pagination",
        clickable: true,
      },
      breakpoints: {
        // Responsividad
        640: { slidesPerView: 1 },
        768: { slidesPerView: 2 },
        1024: { slidesPerView: 3 },
      },
    });
  });
</script>

<style>
  .swiper-slide {
    padding: 1rem; /* Espaciado interno para las tarjetas */
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .swiper-pagination {
    margin-top: 10px; /* Espacio entre el slider y la paginación */
  }
</style>
